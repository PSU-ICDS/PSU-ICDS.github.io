<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://icds-docs.readthedocs.io/en/latest/05_UsingSoftware/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Using Software - ICDS User Guide</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Using Software";
        var mkdocs_page_input_path = "05_UsingSoftware.md";
        var mkdocs_page_url = "/en/latest/05_UsingSoftware/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]--> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="..">
          <img src="../images/PSU_ICDS_logo_blue.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Roar Collab User Guide</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../01_Overview/">Overview</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../02_Connecting/">Connecting</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../03_SubmittingJobs/">Submitting Jobs</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../04_HandlingData/">Handling Data</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Using Software</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#modules">Modules</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#useful-lmod-commands">Useful Lmod Commands</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#custom-software">Custom Software</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#custom-modules">Custom Modules</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#anaconda">Anaconda</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#installation-example">Installation Example</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#useful-anaconda-commands">Useful Anaconda Commands</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#submission-script-usage">Submission Script Usage</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#using-conda-environments-in-interactive-apps">Using Conda Environments in Interactive Apps</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#compiling-from-source">Compiling From Source</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#containers">Containers</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#container-registries">Container Registries</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#useful-apptainer-commands">Useful Apptainer Commands</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#building-container-images">Building Container Images</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#software-specific-guides">Software-Specific Guides</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#python">Python</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#python-versions-on-rc">Python versions on RC</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#install-python-packages-with-pip">Install Python Packages with pip</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#r">R</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#r-versions-on-rc">R Versions on RC</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#install-r-packages">Install R Packages</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#r-package-installation-example">R Package Installation Example</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#r-packages-with-anaconda">R Packages with Anaconda</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    </ul>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">ICDS User Guide</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Using Software</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="using-software">Using Software</h1>
<p>The software stack on Roar Collab (RC) provides a wide variety of software to 
the entire user community. There are two software stacks available on RC.</p>
<ul>
<li><strong>System software stack</strong>: contains software that is available to all users by default upon logging into the system without a need to load anything.</li>
<li><strong>Central software stack</strong>: contains software that is available to all users by default, but the software modules must be loaded in order to access them.</li>
</ul>
<h2 id="modules">Modules</h2>
<p>The central software stack uses <a href="https://lmod.readthedocs.io/en/latest/">Lmod</a> 
to package the available software. Lmod is a useful tool for managing user 
software environments using environment modules that can be dynamically added 
or removed using module files. Lmod is hierarchical, so sub-modules can be 
nested under a module that is dependent upon. Lmod alters environment 
variables, most notably the <code>$PATH</code> variable, in order to make certain software 
packages reachable by the user environment.</p>
<h3 id="useful-lmod-commands">Useful Lmod Commands</h3>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>module avail</code></td>
<td>List all modules that are available to be loaded</td>
</tr>
<tr>
<td><code>module show &lt;module_name&gt;</code></td>
<td>Show the contents of a module</td>
</tr>
<tr>
<td><code>module spider &lt;module_name&gt;</code></td>
<td>Search the module space for a match</td>
</tr>
<tr>
<td><code>module load &lt;module_name&gt;</code></td>
<td>Load module(s)</td>
</tr>
<tr>
<td><code>module load &lt;module&gt;/&lt;version&gt;</code></td>
<td>Load a module of a specific version</td>
</tr>
<tr>
<td><code>module unload &lt;module_name&gt;</code></td>
<td>Unload module(s)</td>
</tr>
<tr>
<td><code>module list</code></td>
<td>List all currently loaded modules</td>
</tr>
<tr>
<td><code>module purge</code></td>
<td>Unload all currently loaded modules</td>
</tr>
<tr>
<td><code>module use &lt;path&gt;</code></td>
<td>Add a path to <code>$MODULEPATH</code> to expand module scope</td>
</tr>
<tr>
<td><code>module unuse &lt;path&gt;</code></td>
<td>Remove a path from <code>$MODULEPATH</code></td>
</tr>
</tbody>
</table>
<p>The central software stack is available to the user environment by default 
since the <code>$MODULEPATH</code> environment variable is set and contains the central 
software stack location. Modules can be directly loaded with</p>
<div class="highlight"><pre><span></span><code>$ module load &lt;package&gt;
</code></pre></div>
<p>To see the available software modules, use
<div class="highlight"><pre><span></span><code>$ module avail
</code></pre></div></p>
<h2 id="custom-software">Custom Software</h2>
<p>Even though a large variety of software packages are available on RC via the 
system and central software stacks, users may need access to additional 
software. Users may also wish to have greater control over the software 
packages that are required for their research workflow.</p>
<h3 id="custom-modules">Custom Modules</h3>
<p>Users can install custom software packages and build custom software modules in 
order to build a custom user- or group-specific software stack. For users and 
groups with well-defined research workflows, it is recommended to create a 
custom software stack to keep close control of the software installation 
versions and configuration. A location should be specified that contains the 
custom software installations and the module files for the custom software 
installations should be stored together in a common location. This module 
location can be added to the <code>$MODULEPATH</code> environment variable so users can 
access the software modules just as they would for the central software stack. The <a href="https://lmod.readthedocs.io/en/latest/">LMod</a> documentation contains more detailed information on creating custom software modules.</p>
<h3 id="anaconda">Anaconda</h3>
<p><a href="https://docs.anaconda.com/index.html">Anaconda</a> is a very useful package 
manager that is available on RC. Package managers simplify software package 
installation and manage dependency relationships while increasing both the 
repeatability and the portability of software. The user environment is modified 
by the package manager so the shell can access different software packages. 
Anaconda was originally created for Python, but it can package and distribute 
software for any language. It is usually very simple to create and manage new 
environments, install new packages, and import/export environments. Many 
packages are available for installation through Anaconda, and it enables 
retaining the environments in a silo to reduce cross-dependencies between 
different packages that may perturb environments.</p>
<p>Anaconda can be loaded from the software stack on RC with the following 
command:
<div class="highlight"><pre><span></span><code>$ module load anaconda
</code></pre></div></p>
<p>Usage of Anaconda may cause storage quota issues since environments and packages are stored within <code>~/.conda</code> by default. This issue can be easily resolved by moving the <code>~/.conda</code> directory to the work directory and creating a link in its place pointing to the new location in the work directory. This is described further in the <a href="../04_HandlingData/#Managing-Large-Configuration-Files">Handling Data</a> section.</p>
<h4 id="installation-example">Installation Example</h4>
<p>After loading the <strong>anaconda</strong> module, environments can be created and packages 
can be installed within those environments. When using the <strong>anaconda</strong> module 
for the first time on RC, the <code>conda init bash</code> command may be required to 
initialize anaconda, then a new session must be started for the change to take 
effect. In the new session, the command prompt will be prepended with <code>(base)</code> 
which denotes that the session is in the base anaconda environment.</p>
<p>To create an environment that contains both numpy and scipy, for example, run 
the following commands:</p>
<div class="highlight"><pre><span></span><code>(base) $ conda create -n py_env
(base) $ conda activate py_env
(py_env) $ conda install numpy
(py_env) $ conda install scipy
</code></pre></div>
<p>Note that after the environment is entered, the leading item in the prompt 
changes to reflect the current environment.</p>
<p>Alternatively, the creation of an environment and package installation can be 
completed with a single line.</p>
<div class="highlight"><pre><span></span><code>(base) $ conda create -n py_env numpy scipy
</code></pre></div>
<p>For more detailed information on usage, check out the 
<a href="https://docs.conda.io/projects/conda/en/latest/index.html">Anaconda documentation</a>.</p>
<h4 id="useful-anaconda-commands">Useful Anaconda Commands</h4>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>conda create –n &lt;env_name&gt;</code></td>
<td>Creates a conda environment by name</td>
</tr>
<tr>
<td><code>conda create –p &lt;env_path&gt;</code></td>
<td>Creates a conda environment by location</td>
</tr>
<tr>
<td><code>conda env list</code></td>
<td>Lists all conda environments</td>
</tr>
<tr>
<td><code>conda env remove –n &lt;env_name&gt;</code></td>
<td>Removes a conda environment by name</td>
</tr>
<tr>
<td><code>conda activate &lt;env_name&gt;</code></td>
<td>Activates a conda environment by name</td>
</tr>
<tr>
<td><code>conda list</code></td>
<td>Lists all packages within an active environment</td>
</tr>
<tr>
<td><code>conda deactivate</code></td>
<td>Deactivates the active conda environment</td>
</tr>
<tr>
<td><code>conda install &lt;package&gt;</code></td>
<td>Installs a package within an active environment</td>
</tr>
<tr>
<td><code>conda search &lt;package&gt;</code></td>
<td>Searches for a package</td>
</tr>
<tr>
<td><code>conda env export &gt; env_name.yml</code></td>
<td>Exports active environment to a file</td>
</tr>
<tr>
<td><code>conda env create –f env_name.yml</code></td>
<td>Loads environment from a file</td>
</tr>
</tbody>
</table>
<h4 id="submission-script-usage">Submission Script Usage</h4>
<p>Slurm does not automatically source the <code>~/.bashrc</code> file in your batch job, so 
Anaconda fails to be properly initialized within Slurm job submission scripts. 
Fortunately, the <strong>anaconda</strong> module intitializes the software so that the 
<code>conda</code> command is automatically available within the Slurm job submission 
script. If using a different anaconda installation, this issue can be resolved 
by directly sourcing the <code>~/.bashrc</code> file in your job script before running any 
conda commands:</p>
<div class="highlight"><pre><span></span><code>source ~/.bashrc
</code></pre></div>
<p>Alternatively, the environment can be activated using <code>source</code> instead of 
<code>conda</code>.</p>
<div class="highlight"><pre><span></span><code>source activate &lt;environment&gt;
</code></pre></div>
<p>Another way to resolve this is to add the following shebang to the top of a 
slurm job script:</p>
<div class="highlight"><pre><span></span><code>#!/usr/bin/env bash -l
</code></pre></div>
<p>Yet another option would be to put the following commands before activating the 
conda environment:</p>
<div class="highlight"><pre><span></span><code>module load &lt;custom anaconda module&gt;
CONDAPATH=`which conda`
eval &quot;$(${CONDAPATH} shell.bash hook)&quot;
</code></pre></div>
<p>To reiterate, the <strong>anaconda</strong> module available on RC is configured such that 
the <code>conda</code> command is automatically available within a Slurm job submission 
sript. The above options are only necessary for other anaconda installations.</p>
<h4 id="using-conda-environments-in-interactive-apps">Using Conda Environments in Interactive Apps</h4>
<p>Environments built with Anaconda can be used in Interactive Apps on the RC 
Portal as well. Typically the environment should be created and configured in 
an interactive compute session on RC, and then some additional steps are needed 
to make the environment available from within an Interactive App.</p>
<h5 id="jupyter-server">Jupyter Server</h5>
<p>To access a conda environment within a Jupyter Server session, the <em>ipykernel</em> 
package must be installed within the environment. To do so, enter the 
environment and run the following commands:</p>
<div class="highlight"><pre><span></span><code>(base) $ conda activate &lt;environment&gt;
(&lt;environment&gt;) $ conda install -y ipykernel
(&lt;environment&gt;) $ ipython kernel install --user --name=&lt;environment&gt;
</code></pre></div>
<p>After the <em>ipykernel</em> package is successfully installed within this 
environment, a Jupyter Server session can be launched via the RC Portal. When 
submitting the form to launch the session, under the <em>Conda environment type</em> 
field, select the <em>Use custom text field</em> option from the dropdown menu. Then 
enter the following into the <em>Environment Setup</em> text field:</p>
<div class="highlight"><pre><span></span><code>module load anaconda
</code></pre></div>
<p>After launching and entering the session, the environment is displayed in the 
kernel list.</p>
<h5 id="rstudio">RStudio</h5>
<p>To launch an RStudio Interactive App session, RStudio must have access to an 
installation of R. R can either be installed within the conda environment 
itself, or it can be loaded from the software stack. Typically, R will be 
installed by default when installing R packages within a conda environment; 
therefore, it is recommended when using conda environments within RStudio to 
simply utilize the environment's own R installation. To create an environment 
containing an R installation, run the following command:</p>
<div class="highlight"><pre><span></span><code>(base) $ conda create -y -n &lt;environment&gt; r
</code></pre></div>
<p>Alternatively, R can simply be added to an existing environment by entering 
that environment and installing using the following command:</p>
<div class="highlight"><pre><span></span><code>(&lt;environment&gt;) $ conda install r &lt;plus any additional R packages&gt;
</code></pre></div>
<p>R packages can installed directly via Anaconda within the environment as well. 
R packages available in Anaconda are usually named <code>r-&lt;package name&gt;</code> such as 
<code>r-plot3d</code>, <code>r-spatial</code>, or <code>r-ggplot</code>.</p>
<p>After R and any necessary R packages are installed within the environment, an 
RStudio session can be launched via the RC Portal. When submitting the form to 
launch the session, under the <em>Environment type</em> field, select the <em>Use custom 
text field</em> option from the dropdown menu. Then enter the following into the 
<em>Environment Setup</em> text field:</p>
<div class="highlight"><pre><span></span><code>module load anaconda
conda activate &lt;environment&gt;
export CONDAENVLIB=~/.conda/envs/&lt;environment&gt;/lib
export LD_LIBRARY_PATH=$CONDAENVLIB:$LD_LIBRARY_PATH
</code></pre></div>
<p>Please note that the default location of conda environments is in 
<code>~/.conda/envs</code>, which is why the <code>CONDAENVLIB</code> variable is being set to 
<code>~/.conda/envs/&lt;environment&gt;/lib</code>. If the environment is instead installed a 
non-default location, then the <code>CONDAENVLIB</code> variable should be set 
accordingly. The two <code>export</code> commands in the block above are required because 
RStudio often has an issue loading some libraries while accessing the conda 
envrionment's R installation. Explicitly adding the conda environment's <em>lib</em> 
directory to the <code>LD_LIBRARY_PATH</code> variable seems to clear up this issue.</p>
<h3 id="compiling-from-source">Compiling From Source</h3>
<p>Compiling software from source is the most involved option for using software 
on RC, but it gives the user the highest level of control. Research computing 
software is often developed by academic researchers that do not place a large 
effort on packaging their software so that it can be easily deployed on other 
systems. If the developer does not package the software using a package 
manager, then the only option is to build the software from source. It is best 
to follow the installation instructions from the developer to successfully 
install the software from source.</p>
<p>It is recommended to build software on a node with the same processor type that 
will be used for running the software. On a compute node, running the following 
command displays the processor type:</p>
<div class="highlight"><pre><span></span><code>$ cat /sys/devices/cpu/caps/pmu_name
</code></pre></div>
<p>Software builds are not typically back-compatible and will not run successfully 
on processors older than the processor used to build. It is recommended to 
build on haswell (the oldest processor architecture on RC) if you wish to have 
full compatibility across all RC compute nodes. To optimize for performance, 
however, build on the same processor on which the software runs.</p>
<pre><code>| Release Date | Processor |
| :----: | :----: |
| 2013 | haswell |
| 2014 | broadwell |
| 2015 | skylake |
| 2019 | cascadelake |
| 2019 | icelake |
| 2023 | sapphirerapids |
</code></pre>
<h3 id="containers">Containers</h3>
<p>A container is a standard unit of software with two modes:</p>
<ol>
<li>Idle: When idle, a container is a file that stores everything an application (or collection of applications) requires to run (code, runtime, system tools, system libraries and settings).</li>
<li>Running: When running, a container is a Linux process running on top of the host machine kernel with a user environment defined by the contents of the container file, not by the host OS.</li>
</ol>
<p>A container is an abstraction at the application layer. Multiple containers can 
run on the same machine and share the host kernel with other containers, each 
running as isolated processes.</p>
<p>Apptainer is a secure container platform designed for HPC use cases and is 
available on RC. Containers (or images) can either be pulled directly from a 
container repository or can be built from a definition file. A definition file 
or recipe file contains everything required to build a container. Building 
containers requires root privileges, so containers are built on your personal 
device and can be deployed on RC.</p>
<p>Software is continuously growing in complexity which can make managing the 
required user environment and wrangling dependent software an intractable 
problem. Containers address this issue by storing the software and all of its 
dependencies (including a minimal operating system) in a single image file, 
eliminating the need to install additional packages or alter the runtime 
environment. This makes the software both shareable and portable while the 
output becomes reproducible.</p>
<p>In a Slurm submission script, a container can be called serially using the 
following run line:</p>
<div class="highlight"><pre><span></span><code>$ apptainer run &lt;container&gt; &lt;args&gt;
</code></pre></div>
<p>To use a container in parallel with MPI, the MPI library within the container 
must be compatible with the MPI implementation on the system, meaning that the 
MPI version on the system must generally be newer than the MPI version within 
the container. More details on using MPI with containers can be found on 
Apptainer's 
<a href="https://apptainer.org/docs/user/1.0/mpi.html">Apptainer and MPI Applications</a> 
page. In a Slurm submission script, a container with MPI can be called using</p>
<div class="highlight"><pre><span></span><code>$ srun apptainer exec &lt;container&gt; &lt;command&gt; &lt;args&gt;
</code></pre></div>
<p>Containers change the user space into a swappable component, and provide the 
following benefits:</p>
<ul>
<li>Flexibility: Bring your own environment (BYOE) and bring your own software (BYOS)</li>
<li>Reproducibility: Complete control over software versions</li>
<li>Portability: Run a container on your laptop or on HPC systems</li>
<li>Performance: Similar performance characteristics as native applications</li>
<li>Compatibility: Open standard that is supported on all major Linux distributions</li>
</ul>
<h4 id="container-registries">Container Registries</h4>
<p>Container images can be made publicly available, and containers for many use 
cases can be found at the following container registries:</p>
<ul>
<li><a href="https://hub.docker.com/">Docker Hub</a></li>
<li><a href="https://singularityhub.github.io/singularityhub-docs/">Singularity Hub</a></li>
<li><a href="https://cloud.sylabs.io/library">Singularity Cloud Library</a></li>
<li><a href="https://ngc.nvidia.com/catalog/containers">NVIDIA GPU Cloud</a></li>
<li><a href="https://quay.io/">Quay.io</a></li>
<li><a href="https://biocontainers.pro/">BioContainers</a></li>
</ul>
<h4 id="useful-apptainer-commands">Useful Apptainer Commands</h4>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>apptainer build &lt;container&gt; &lt;definition&gt;</code></td>
<td>Builds a container from a definition file</td>
</tr>
<tr>
<td><code>apptainer shell &lt;container&gt;</code></td>
<td>Runs a shell within a container</td>
</tr>
<tr>
<td><code>apptainer exec &lt;container&gt; &lt;command&gt;</code></td>
<td>Runs a command within a container</td>
</tr>
<tr>
<td><code>apptainer run &lt;container&gt;</code></td>
<td>Runs a container where a runscript is defined</td>
</tr>
<tr>
<td><code>apptainer pull &lt;resource&gt;://&lt;container&gt;</code></td>
<td>Pulls a container from a container registry</td>
</tr>
<tr>
<td><code>apptainer build --sandbox &lt;sbox&gt; &lt;container&gt;</code></td>
<td>Builds a sandbox from a container</td>
</tr>
<tr>
<td><code>apptainer build &lt;container&gt; &lt;sbox&gt;</code></td>
<td>Builds a container from a sandbox</td>
</tr>
</tbody>
</table>
<h4 id="building-container-images">Building Container Images</h4>
<p>Containers can be made from scratch using a 
<a href="https://apptainer.org/docs/user/latest/definition_files.html#definition-files">definition file</a>, 
or recipe file, which is a text file that specifies the base image, the 
software to be installed, and other information. The documentation for the 
<a href="https://apptainer.org/docs/user/main/cli/apptainer_build.html"><code>apptainer build</code></a> 
command shows the full usage for the build command. Container images can also 
be bootstrapped from other images, found on Docker Hub for instance.</p>
<p>The recommended workflow for building containers is shown below:</p>
<p><center>
<img alt="Recommended container workflow." src="../images/ContainerWorkflow.png" />
</center></p>
<h2 id="software-specific-guides">Software-Specific Guides</h2>
<h3 id="python">Python</h3>
<p>Python is a high-level, general-purpose programming language.</p>
<h4 id="python-versions-on-rc">Python versions on RC</h4>
<p>Python is available by default to all users on the system software stack, and 
it is also available on the central software stack. Additionally, users can 
install their own instances of Python in a variety of ways in either their 
userspace or in group spaces.</p>
<h4 id="install-python-packages-with-pip">Install Python Packages with <code>pip</code></h4>
<p>Python packages can be installed easily using <code>pip</code>. By default, <code>pip</code> will 
attempt to install packages to a system location, but RC is a shared system. 
Users do not have write access to system locations on shared systems. The 
packages can instead be installed in <em>~/.local</em>, which is a user location, 
using the following:</p>
<div class="highlight"><pre><span></span><code>$ pip install --user &lt;package&gt;
</code></pre></div>
<p>Also, packages can be installed to a custom specified location using the 
<code>--target</code> option:</p>
<div class="highlight"><pre><span></span><code>$ pip install --target=&lt;install_dir&gt; &lt;package&gt;
</code></pre></div>
<p>Note that if <code>pip</code> is not available, simply try <code>pip3</code> (for python3) or <code>pip2</code> 
(for python2) instead.</p>
<h3 id="r">R</h3>
<p>R is a free software environment for statistical computing and graphics.</p>
<h4 id="r-versions-on-rc">R Versions on RC</h4>
<p>R users should make sure that the version of R remains consistent. RC has 
several R versions available, and when a package is installed in one version, 
it is not always accessible when operating in another version. Always check the 
R version and remain consistent! R modules can be loaded from the central 
software stack, and R can also be installed by users in a variety of ways 
within their userspace or group spaces.</p>
<h4 id="install-r-packages">Install R Packages</h4>
<p>R manages some dependencies and versions through the CRAN-like repos. R 
packages can be installed from within the R console with the following command:</p>
<div class="highlight"><pre><span></span><code>&gt; install.packages( &lt;package&gt; )
</code></pre></div>
<p>Upon running the install command, a warning usually appears stating that the 
default system install location is not writable, so it asks to install in a 
personal library instead. After entering "yes" as a response, it may then ask 
to create a personal library location. Responding "yes" again will proceed with 
the installation, probably by asking to select a CRAN repository.</p>
<p>The default personal directory described above will install the package in the 
<code>~/R/</code> directory. An install location can instead be supplied to the install 
command using the <code>lib</code> argument:</p>
<div class="highlight"><pre><span></span><code>&gt; install.packages( &quot;&lt;package&gt;&quot;, lib=&quot;&lt;install_location&gt;&quot; )
</code></pre></div>
<p>After installation, packages can then be loaded using the following command in 
the R console:</p>
<div class="highlight"><pre><span></span><code>&gt; library( &lt;package&gt; )
</code></pre></div>
<p>If the package was installed in a non-standard location, then the package can 
be loaded from that custom install location using the <code>lic.loc</code> argument of the 
<code>library()</code> command:</p>
<div class="highlight"><pre><span></span><code>&gt; library( &lt;package&gt;, lib.loc=&quot;&lt;install_location&gt;&quot; )
</code></pre></div>
<p>It is recommended to review dependencies of any packages to be installed 
because additional software may have to be loaded in the environment before 
launching the R console. For example, some R packages utilize CMake to perform 
the installation. In that case, the <em>cmake</em> module should be loaded before 
launching the R console session.</p>
<h4 id="r-package-installation-example">R Package Installation Example</h4>
<p>To install the ggplot2 R package, first search ggplot2 online to see if there 
are installation instructions. A quick search shows that ggplot2 is included in 
the tidyverse package and that the recommended installation instructions are 
the following:</p>
<div class="highlight"><pre><span></span><code># The easiest ways to get ggplot2 is to install the whole tidyverse package:
&gt; install.packages(&quot;tidyverse&quot;)

# Alternatively, install just ggplot2:
&gt; install.packages(&quot;ggplot2&quot;)
</code></pre></div>
<p>Searching for install instructions usually provides all the necessary 
information!</p>
<p>Some R packages may require changes to the user environment before the package 
can be installed successfully within the R console. Typically, the user 
environment change is as simple as accessing a newer compiler version by 
loading a software module like <em>intel</em> with</p>
<div class="highlight"><pre><span></span><code>$ module load intel
</code></pre></div>
<p>Sometimes, installing R packages may be a little more involved. To install the 
<em>units</em> R package, for example, an additional library must be downloaded and 
installed locally in order for the package to be installed properly. To install 
the <em>units</em> R package on RC, perform the following commands in an interactive 
session on a compute node:</p>
<div class="highlight"><pre><span></span><code>$ cd ~/scratch
$ wget https://downloads.unidata.ucar.edu/udunits/2.2.28/udunits-2.2.28.tar.gz
$ tar -xvf udunits-2.2.28.tar.gz
$ cd udunits-2.2.28
$ ./configure prefix=$HOME/.local
$ make
$ make install
$ export UDUNITS2_INCLUDE=$HOME/.local/include
$ export UDUNITS2_LIBS=$HOME/.local/lib
$ export LD_LIBRARY_PATH=$HOME/.local/lib:$LD_LIBRARY_PATH
$ module load r/4.2.1
$ R
&gt; install.packages(&quot;units&quot;)
&gt; library(units)
</code></pre></div>
<h4 id="r-packages-with-anaconda">R Packages with Anaconda</h4>
<p>The R installation itself and its R packages can be easily installed and 
managed within an conda environment. Creating a conda environment containing 
its own R installation and some R packages can be accomplished with the 
following:</p>
<div class="highlight"><pre><span></span><code>(base) $ conda create -n r_env
(base) $ conda activate r_env
(r_env) $ conda install r-base
(r_env) $ conda install r-tidyverse
</code></pre></div>
<p>Note that after <code>r-base</code> is the base R installation, and R packages (or in the 
case of <code>tidyverse</code>, a bundle of packages) usually are named <code>r-*</code> in conda 
repos.</p>
<p>Alternatively, the creation of this environment can be completed with a single 
line.</p>
<div class="highlight"><pre><span></span><code>(base) $ conda create -n r_env r-base r-tidyverse
</code></pre></div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../04_HandlingData/" class="btn btn-neutral float-left" title="Handling Data"><span class="icon icon-circle-arrow-left"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../04_HandlingData/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
